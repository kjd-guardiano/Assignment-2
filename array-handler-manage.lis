     1                                  ;Array Handler - Manage
     2                                  ;Katherine Joy Guardiano, 240-3
     3                                  
     4                                  ; ==== Code Area Start ====
     5                                  global manage
     6                                  extern fillarray
     7                                  extern sumarray
     8                                  extern display
     9                                  extern scanf ;for calling the function scanf
    10                                  extern printf ;for calling the function printf
    11                                  
    12                                  segment .data
    13                                  ; ==== Data Declarations ====
    14                                  max_size equ 8 ;8 cells in the array
    15                                  
    16                                  ; ==== Format Declarations ====
    17 00000000 456E74657220666C6F-     prefillmsg db "Enter float numbers separated by white space. After last number, enter white space followed by CTRL+D.", 10, 0
    17 00000009 6174206E756D626572-
    17 00000012 732073657061726174-
    17 0000001B 656420627920776869-
    17 00000024 74652073706163652E-
    17 0000002D 204166746572206C61-
    17 00000036 7374206E756D626572-
    17 0000003F 2C20656E7465722077-
    17 00000048 686974652073706163-
    17 00000051 6520666F6C6C6F7765-
    17 0000005A 64206279204354524C-
    17 00000063 2B442E0A00         
    18 00000068 5468616E6B20796F75-     postfillmsg db "Thank you for your input. The numbers received in the array are:", 10, 0
    18 00000071 20666F7220796F7572-
    18 0000007A 20696E7075742E2054-
    18 00000083 6865206E756D626572-
    18 0000008C 732072656365697665-
    18 00000095 6420696E2074686520-
    18 0000009E 617272617920617265-
    18 000000A7 3A0A00             
    19 000000AA 54686520746F74616C-     postsummsg db "The total sum of these numbers is %lf.", 10 ,0
    19 000000B3 2073756D206F662074-
    19 000000BC 68657365206E756D62-
    19 000000C5 65727320697320256C-
    19 000000CE 662E0A00           
    20 000000D2 5468616E6B20796F75-     asmexitmsg db "Thank you for using the Array Management System.", 10, 0
    20 000000DB 20666F72207573696E-
    20 000000E4 672074686520417272-
    20 000000ED 6179204D616E616765-
    20 000000F6 6D656E742053797374-
    20 000000FF 656D2E0A00         
    21 00000104 256C6600                floatform db "%lf", 0 ;8-byte float format
    22 00000108 257300                  stringform db "%s", 0 ;string format
    23 0000010B 546869732069732061-     testmsg db "This is a test output.", 10, 0
    23 00000114 2074657374206F7574-
    23 0000011D 7075742E0A00       
    24                                  
    25                                  segment .bss
    26 00000000 <res 40h>               nicearray resq max_size ;max_size acts as a constant
    27                                  
    28                                  align 64
    29 00000040 <res 1A00h>             backuparea resq 832 
    30                                  
    31                                  segment .text
    32                                  ; ==== Start of Code ====
    33                                  manage:
    34                                  ; ==== Start of Backup ====
    35 00000000 55                      push       rbp                                              ;Save a copy of the stack base pointer
    36 00000001 4889E5                  mov        rbp, rsp                                         ;We do this in order to be 100% compatible with C and C++.
    37 00000004 53                      push       rbx                                              ;Back up rbx
    38 00000005 51                      push       rcx                                              ;Back up rcx
    39 00000006 52                      push       rdx                                              ;Back up rdx
    40 00000007 56                      push       rsi                                              ;Back up rsi
    41 00000008 57                      push       rdi                                              ;Back up rdi
    42 00000009 4150                    push       r8                                               ;Back up r8
    43 0000000B 4151                    push       r9                                               ;Back up r9
    44 0000000D 4152                    push       r10                                              ;Back up r10
    45 0000000F 4153                    push       r11                                              ;Back up r11
    46 00000011 4154                    push       r12                                              ;Back up r12
    47 00000013 4155                    push       r13                                              ;Back up r13
    48 00000015 4156                    push       r14                                              ;Back up r14
    49 00000017 4157                    push       r15                                              ;Back up r15
    50 00000019 9C                      pushf                                                       ;Back up rflags
    51                                  ; ==== End of Backup ====
    52                                  
    53 0000001A B800000000              mov rax, 0
    54 0000001F 48BF-                   mov rdi, stringform
    54 00000021 [0801000000000000] 
    55 00000029 48BE-                   mov rsi, prefillmsg
    55 0000002B [0000000000000000] 
    56 00000033 E8(00000000)            call printf
    57                                  
    58                                  ;block to call fill array
    59 00000038 B800000000              mov rax, 0
    60 0000003D 48BF-                   mov rdi, nicearray ;gives address of array
    60 0000003F [0000000000000000] 
    61 00000047 BE08000000              mov rsi, max_size ;gives maximum size for array
    62 0000004C E8(00000000)            call fillarray
    63 00000051 4889C3                  mov rbx, rax ;store num elements read in rbx
    64                                  
    65 00000054 B800000000              mov rax, 0
    66 00000059 48BF-                   mov rdi, stringform
    66 0000005B [0801000000000000] 
    67 00000063 48BE-                   mov rsi, postfillmsg
    67 00000065 [6800000000000000] 
    68 0000006D E8(00000000)            call printf
    69                                  
    70 00000072 48BF-                   mov rdi, nicearray
    70 00000074 [0000000000000000] 
    71 0000007C 4889DE                  mov rsi, rbx
    72 0000007F E8(00000000)            call display
    73                                  
    74 00000084 F2440F10E8              movsd xmm13, xmm0
    75                                  
    76 00000089 B800000000              mov rax, 0
    77 0000008E 48BF-                   mov rdi, nicearray
    77 00000090 [0000000000000000] 
    78 00000098 4889DE                  mov rsi, rbx
    79 0000009B E8(00000000)            call sumarray
    80                                  
    81 000000A0 F2410F10C5              movsd xmm0, xmm13
    82                                  
    83 000000A5 B801000000              mov rax, 1
    84 000000AA 48BF-                   mov rdi, postsummsg
    84 000000AC [AA00000000000000] 
    85 000000B4 E8(00000000)            call printf
    86                                  
    87 000000B9 B800000000              mov rax, 0
    88 000000BE 48BF-                   mov rdi, stringform
    88 000000C0 [0801000000000000] 
    89 000000C8 48BE-                   mov rsi, asmexitmsg
    89 000000CA [D200000000000000] 
    90 000000D2 E8(00000000)            call printf
    91                                  
    92 000000D7 F2410F10C5              movsd xmm0, xmm13
    93                                  ; ==== Start of Restore ====
    94 000000DC 9D                      popf
    95 000000DD 415F                    pop     r15
    96 000000DF 415E                    pop     r14
    97 000000E1 415D                    pop     r13
    98 000000E3 415C                    pop     r12
    99 000000E5 415B                    pop     r11
   100 000000E7 415A                    pop     r10
   101 000000E9 4159                    pop     r9
   102 000000EB 4158                    pop     r8
   103 000000ED 5F                      pop     rdi
   104 000000EE 5E                      pop     rsi
   105 000000EF 5A                      pop     rdx
   106 000000F0 59                      pop     rcx
   107 000000F1 5B                      pop     rbx
   108 000000F2 5D                      pop     rbp
   109                                  ; ==== End of Restore ====
   110 000000F3 C3                      ret
   111                                  ; ==== End of Code ====
